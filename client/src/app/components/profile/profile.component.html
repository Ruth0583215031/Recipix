<div class="profile-container" *ngIf="user" style="direction: rtl; padding: 20px;">
  <div class="user-info-card shadow-sm" style="background: #fdfdfd; padding: 30px; border-radius: 15px; border: 1px solid #eee;">
    <h2>שלום, {{ user.user_name }} 👋</h2>
    <p>דרגת הרשאה נוכחית: <span class="badge bg-secondary">{{ user.role }}</span></p>

    <div *ngIf="user.role === 'Reader'" class="mt-4">
      <button *ngIf="!user.has_requested" (click)="requestUpgrade()" class="btn btn-warning fw-bold">🚀 בקש להפוך למעלה תוכן</button>
      <div *ngIf="user.has_requested" class="alert alert-info d-inline-block">⏳ בקשת השדרוג שלך ממתינה לאישור מנהל</div>
    </div>

    <hr class="my-4">

    <div *ngIf="user.role === 'Admin' || user.is_approved">
      <button class="btn btn-dark mb-3" (click)="showAddForm = !showAddForm">
        {{ showAddForm ? '❌ סגור טופס' : '➕ הוסף מתכון חדש' }}
      </button>
      <app-add-recipe *ngIf="showAddForm" class="mt-3 d-block"></app-add-recipe>
    </div>
  </div>

  <div class="admin-section mt-5" *ngIf="user.role === 'Admin'">
    <div class="row">
      <div class="col-md-6">
        <h3 class="text-danger">📂 ארכיון מתכונים</h3>
        <table class="table table-sm table-hover bg-white border">
          <thead class="table-dark"><tr><th>שם המתכון</th><th>פעולה</th></tr></thead>
          <tbody>
            <tr *ngFor="let r of archivedRecipes">
              <td>{{ r.name }}</td>
              <td><button (click)="restoreRecipe(r.id)" class="btn btn-success btn-sm">♻️ שחזר</button></td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="col-md-6">
        <h3 class="text-warning">🔔 בקשות שדרוג</h3>
        <ul class="list-group">
          <li *ngFor="let req of requests" class="list-group-item d-flex justify-content-between align-items-center">
            {{ req.user_name }}
            <button (click)="approve(req.id)" class="btn btn-primary btn-sm">אשר</button>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>